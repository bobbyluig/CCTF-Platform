function getURLParameter(t){return(new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20")||null}function subarray(t,e){var a=[];for(i=0;i<t.length;i++)a[i]=t[i]-e[i];return a}function ajax_stats(t){0==t.success&&($("#preload .container").empty(),$("#preload .container").html('<h5 class="center light">'+t.message+"</h5>"));var e=0;for(var a in t.challenges){cat=a,a=t.challenges[a];var n=a.length,i=0,r=$('<div class="collection">');a.forEach(function(t){var e="white";1==t.solved?(e="green lighten-5",i+=1):1==t.deactivated&&(e="red lighten-5"),r.append('<a class="'+e+' collection-item">'+t.title+'<span class="badge">'+t.score+"</span></a>")});var s=$("<li>").appendTo($("#data")),o=$('<div class="collapsible-header"><i class="'+icon_map[cat]+'"></i>'+cat+" - "+i+"/"+n+"</div>").appendTo(s);n===i&&o.addClass("green lighten-5"),$("<div>").attr("class","collapsible-body").append(r).appendTo(s),e+=i}$("#data").collapsible(),$("h2").text(t.team),$("#1").text(t.score),$("#2").text(t.lost),$("#3").text(e),$("#4").text(t.bonus),$("#5").text(t.fails);var l=parseFloat(e/(e+t.fails)*100).toFixed(2);isNaN(l)?l="Undefined":l+="%",$("#6").text(l),$("#7").text(t.usedip),$("#8").text(t.success),$("#9").text(t.fail);var d=parseFloat(t.success/(t.success+t.fail)*100).toFixed(2);isNaN(d)?d="Undefined":d+="%",$("#10").text(d),t.origin.length>0?t.origin.forEach(function(t){var e=$("<tr>").appendTo($("#origin tbody"));$("<td>").appendTo(e).text(t[0]),$("<td>").appendTo(e).text(t[1]),$("<td>").appendTo(e).text(t[2])}):$("#origin").remove(),t.destination.length>0?t.destination.forEach(function(t){var e=$("<tr>").appendTo($("#destination tbody"));$("<td>").appendTo(e).text(t[0]),$("<td>").appendTo(e).text(t[1]),$("<td>").appendTo(e).text(t[2])}):$("#destination").remove(),$("#preload").hide(),$("#main").show()}function ajax_graph(t){if(t.success===!1)return $("#graph .valign-wrapper").empty(),$("#graph .valign-wrapper").html('<h5 class="center light">'+t.message+"</h5>"),!1;var e={chart:{renderTo:"graph"},xAxis:{type:"datetime"},series:[{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"Base Points",data:t.base_score},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"Offensive IP",data:t.used_ip},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"O. IP (S)",data:t.successful_ip},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"O. IP (F)",data:subarray(t.used_ip,t.successful_ip)},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"Defensive IP",data:t.total_attempted},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"D. IP (S) ",data:t.total_lost},{pointStart:1e3*t.start,pointInterval:1e3*t.interval,name:"D. IP (F)",data:subarray(t.total_attempted,t.total_lost)}],credits:{enabled:!1},title:{text:"Team Progression Data"},yAxis:{title:"Value",floor:0}},a=new Date;Highcharts.setOptions({global:{timezoneOffset:a.getTimezoneOffset()}});new Highcharts.Chart(e)}icon_map={Cryptography:"mdi-communication-vpn-key",Exploitation:"mdi-hardware-security",Forensics:"mdi-action-search",Programming:"mdi-editor-mode-edit",Reconnaissance:"mdi-action-explore",Miscellaneous:"mdi-social-share"};var d1=$.get("/api/team/stats/?t="+getURLParameter("t")),d2=$.get("/api/team/graph/?t="+getURLParameter("t"));$(document).ready(function(){$(".button-collapse").sideNav(),$(".modal-trigger").leanModal(),$.when(d1).done(function(t){ajax_stats(t),$.when(d2).done(function(t){ajax_graph(t)})})});