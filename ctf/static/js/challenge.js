function objsort(e,t){e.sort(function(e,a){return e[1][t]>a[1][t]?1:a[1][t]>e[1][t]?-1:0})}function list_challenges(){categories=[],data={},cache.forEach(function(e){e=e[1],category=e.category,categories.indexOf(category)>-1||(categories.push(category),data[category]=$('<div class="collection">'));var t="white";1==e.solved?t="green lighten-5":1==e.deactivated&&(t="red lighten-5"),data[category].append('<a href="'+e.id+'" id="challenge" class="'+t+' collection-item">'+e.title+'<span class="badge">'+e.score+"</span></a>")}),categories.sort(),$("#chal-view ul").empty();var e=0;categories.forEach(function(t){var a=data[t].children().length,r=data[t].children(".green").length,o=$("<li>").appendTo($("#data")),i=$('<div class="collapsible-header"><i class="'+icon_map[t]+'"></i>'+t+" - "+r+"/"+a+"</div>").appendTo(o);$("<div>").attr("class","collapsible-body").append(data[t]).appendTo(o),a===r&&i.addClass("green lighten-5"),e+=r}),$("#data").collapsible(),$("#chal-view ul").show(),$({someValue:parseInt($("#count").text())}).animate({someValue:e},{duration:2e3,easing:"swing",step:function(){$("#count").text(Math.ceil(this.someValue))}}),$(".valign-wrapper").hide(),$("#chal-view ul").show()}function refresh_challenges(){return $("#chal-view ul").hide().empty(),$(".valign-wrapper").show(),$.ajax({type:"GET",url:"/api/challenges/name_list/",success:function(e){return 0==e.success?(Materialize.toast(e.message,3e3,"",function(){$(".challenge-nav").sideNav("hide")}),!1):($.each(e,function(e,t){$.each(t,function(t,a){var r=cache.filter(function(e){return e[1].id==a.id})[0];void 0!==r?(r[1].solved=a.solved,r[1].solves=a.solves):(a.category=e,cache.push([a.id,a]))})}),objsort(cache,sort_order),list_challenges(cache),$(".collapsible").collapsible(),void(localStorage.challenge_cache=JSON.stringify(cache)))}}),!1}function display_challenge(e){var t=cache.filter(function(t){return t[1].id==e})[0];t=t[1],"description"in t&&"1"!=t.type?update_display(t):$.ajax({type:"GET",url:"/api/challenges/get_challenge/",data:{id:e},success:function(e){return 0==e.success?void Materialize.toast(e.message,3e3):(t.description=e.description,t.solves=e.solves,update_display(t),localStorage.challenge_cache=JSON.stringify(cache),void 0)}})}function update_display(e){$("#title").text(e.title+" - "+e.score),$("#description").html(e.description),$("#solves").text(e.solves),$('input[name="id"]').val(e.id),$("ul.tabs").tabs("select_tab","solve-view");var t=0;t=$(".card").height()>$(window).height()?$(".card").offset().top:$(".card").offset().top-$(window).height()/2+$(".card").height()/2,$("html, body").animate({scrollTop:t},500)}!function(e,t){function a(t){t.preventDefault(),e.event.remove(x,"click",a)}function r(e,t){return(f?t.originalEvent.touches[0]:t)["page"+e.toUpperCase()]}function o(t,r,o){var i=e.Event(r,w);e.event.trigger(i,{originalEvent:t},t.target),i.isDefaultPrevented()&&(~r.indexOf("tap")&&!f?e.event.add(x,"click",a):t.preventDefault()),o&&(e.event.remove(x,y+"."+_,n),e.event.remove(x,$+"."+_,c))}function i(t){var i=t.timeStamp||+new Date;d!=i&&(d=i,b.x=w.x=r("x",t),b.y=w.y=r("y",t),b.time=i,b.target=t.target,w.orientation=null,w.end=!1,l=!1,s=!1,h=setTimeout(function(){s=!0,o(t,"press")},e.Finger.pressDuration),e.event.add(x,y+"."+_,n),e.event.add(x,$+"."+_,c),S.preventDefault&&(t.preventDefault(),e.event.add(x,"click",a)))}function n(t){if(w.x=r("x",t),w.y=r("y",t),w.dx=w.x-b.x,w.dy=w.y-b.y,w.adx=Math.abs(w.dx),w.ady=Math.abs(w.dy),l=w.adx>S.motionThreshold||w.ady>S.motionThreshold){for(clearTimeout(h),w.orientation||(w.adx>w.ady?(w.orientation="horizontal",w.direction=w.dx>0?1:-1):(w.orientation="vertical",w.direction=w.dy>0?1:-1));t.target&&t.target!==b.target;)t.target=t.target.parentNode;return t.target!==b.target?(t.target=b.target,void c.call(this,e.Event($+"."+_,t))):void o(t,"drag")}}function c(e){var t,a=e.timeStamp||+new Date,r=a-b.time;if(clearTimeout(h),l||s||e.target!==b.target)e.target=b.target,S.flickDuration>r&&o(e,"flick"),w.end=!0,t="drag";else{var i=g===e.target&&S.doubleTapInterval>a-u;t=i?"doubletap":"tap",g=i?null:b.target,u=a}o(e,t,!0)}var l,s,d,h,g,u,p=/chrome/i.exec(t),v=/android/i.exec(t),f="ontouchstart"in window&&!(p&&!v),m=f?"touchstart":"mousedown",$=f?"touchend touchcancel":"mouseup mouseleave",y=f?"touchmove":"mousemove",_="finger",x=e("html")[0],b={},w={},S=e.Finger={pressDuration:300,doubleTapInterval:300,flickDuration:150,motionThreshold:5};e.event.add(x,m+"."+_,i)}(jQuery,navigator.userAgent);var cache=[],sort_order="title";"undefined"!=typeof Storage&&(localStorage.challenge_cache||localStorage.setItem("challenge_cache","[]"),localStorage.challenge_sortorder||localStorage.setItem("challenge_sortorder","title"),cache=JSON.parse(localStorage.challenge_cache),sort_order=localStorage.challenge_sortorder),"title"===sort_order?$("#order1").prop("checked",!0):$("#order2").prop("checked",!0),$(".button-collapse").sideNav(),$(".modal-trigger").leanModal(),icon_map={Cryptography:"mdi-communication-vpn-key",Exploitation:"mdi-hardware-security",Forensics:"mdi-action-search",Programming:"mdi-editor-mode-edit",Reconnaissance:"mdi-action-explore",Miscellaneous:"mdi-social-share"},$("body").on("click","#challenge",function(){return display_challenge($(this).attr("href")),!1}),$("form").submit(function(){return"0"==$(this).find('input[type="hidden"]').val()?(Materialize.toast("Select a challenge first!",2e3),!1):(form=$(this),$.ajax({type:"POST",url:$(this).attr("action"),data:$(this).serialize(),success:function(e){e.success&&(refresh_challenges(),$("#solves").text(e.solves)),form[0].reset(),form.find("i, label").removeClass("active"),form.find("input").blur(),Materialize.toast(e.message,150*e.message.length)}}),!1)}),$(document).ready(function(){refresh_challenges(),$("input[name=sortorder]").change(function(){sort_order=$(this).data("sort"),objsort(cache,sort_order),list_challenges(),localStorage.challenge_sortorder=sort_order}),$('a[href="#chal-view"]').dblclick(function(){refresh_challenges()}),$('a[href="#chal-view"]').on("doubletap",function(){refresh_challenges()}),$("#clear-cache").click(function(){return localStorage.clear(),cache=[],refresh_challenges(),!1})});